<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Audio + obraz po akceptacji cookies</title>
  <style>
    html, body { margin:0; padding:0; height:100%; background:#000; font-family:system-ui,sans-serif; }
    /* Baner cookies pełny ekran */
    #cookieOverlay {
      position:fixed; inset:0; background: rgba(0,0,0,0.85); color:#fff;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      text-align:center; z-index:9999; padding:20px;
    }
    #cookieOverlay.hidden { display:none; }
    #cookieOverlay .btn {
      padding:12px 18px; margin:8px; border:none; border-radius:10px; cursor:pointer; font-weight:700;
    }
    #acceptBtn { background:#0f62fe; color:white; }
    #declineBtn { background:transparent; color:#cbd5e1; border:1px solid rgba(255,255,255,0.2); }

    /* Obraz pełny ekran, niewidoczny na początku */
    #mainImage {
      position:fixed; inset:0; width:100%; height:100%; object-fit:cover;
      opacity:0; transition: opacity 1s ease;
      z-index:1;
    }
    #mainImage.visible { opacity:1; }

  </style>
</head>
<body>

  <!-- Baner cookies -->
  <div id="cookieOverlay">
    <h1>By korzystać z tej strony musisz zaakceptować pliki cookies</h1>
    <p>Kliknij "Akceptuję", aby wyświetlić zawartość strony i odtworzyć dźwięk.</p>
    <div>
      <button id="declineBtn">Odrzuć</button>
      <button id="acceptBtn">Akceptuję</button>
    </div>
  </div>

  <!-- Obraz 10.png -->
  <img id="mainImage" src="10.png" alt="Pełnoekranowy obraz">

  <script>
    const COOKIE_NAME = 'cookiesAccepted_v1';
    const COOKIE_DAYS = 365;
    const AUDIO_FILE = '10.mp3';

    const overlay = document.getElementById('cookieOverlay');
    const acceptBtn = document.getElementById('acceptBtn');
    const declineBtn = document.getElementById('declineBtn');
    const mainImage = document.getElementById('mainImage');

    // przygotuj audio
    const audio = new Audio(AUDIO_FILE);
    audio.loop = true;
    audio.volume = 1.0;
    audio.preload = 'auto';
    audio.playsInline = true;

    function setCookie(name, value, days){
      const d = new Date();
      d.setTime(d.getTime() + (days*24*60*60*1000));
      document.cookie = name + "=" + encodeURIComponent(value) + ";expires=" + d.toUTCString() + ";path=/;SameSite=Lax";
    }
    function getCookie(name){
      const decoded = decodeURIComponent(document.cookie);
      const ca = decoded.split(';');
      const key = name + "=";
      for(let c of ca){
        while(c.charAt(0) === ' ') c = c.substring(1);
        if(c.indexOf(key) === 0) return c.substring(key.length);
      }
      return null;
    }

    function showContent(){
      overlay.classList.add('hidden');
      mainImage.classList.add('visible');
      audio.play().catch(err=>{
        console.warn('Autoplay zablokowany. Kliknij w stronę, aby odtworzyć audio.', err);
      });
    }

    acceptBtn.addEventListener('click', ()=>{
      setCookie(COOKIE_NAME,'1',COOKIE_DAYS);
      showContent();
    });

    declineBtn.addEventListener('click', ()=>{
      alert('Nie udzielono zgody. Strona pozostaje zablokowana.');
    });

    // jeśli zgoda już była
    document.addEventListener('DOMContentLoaded', ()=>{
      if(getCookie(COOKIE_NAME) === '1'){
        showContent();
      }
    });
  </script>

</body>
</html>
